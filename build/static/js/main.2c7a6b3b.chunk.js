(this.webpackJsonpstrangersthings=this.webpackJsonpstrangersthings||[]).push([[0],{38:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n(5),c=n.n(r),a=n(11),o=n(6),i=n(0),u=n(22),j=n.n(u),p=n(3),h=n(7),l={backgroundColor:"olive"},d=(n(32),function(e){var t=e.type,n=e.setToken,r=e.setUser,u=Object(i.useState)(""),j=Object(o.a)(u,2),l=j[0],d=j[1],b=Object(i.useState)(""),x=Object(o.a)(b,2),O=x[0],g=x[1],f="login"===t?"Login":"Register",m="login"===t?"Register":"Login",v="login"===t?"register":"login",k=Object(p.e)(),y=function(){var e=Object(a.a)(c.a.mark((function e(s){var a,o,i,u,j,p,h;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),console.log("username: ",l),console.log("password: ",O),e.next=5,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/".concat(t),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:{username:l,password:O}})});case 5:return a=e.sent,console.log("response: ",a),e.next=9,a.json();case 9:if(o=e.sent,i=o.data,console.log("{data}: ",{data:i}),u=null===i||void 0===i?void 0:i.token,console.log("token: ",u),!u){e.next=29;break}return localStorage.setItem("token",u),n(u),e.next=19,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{method:"GET",headers:{Authorization:"Bearer ".concat(u)}});case 19:return j=e.sent,e.next=22,j.json();case 22:p=e.sent,h=p.data,console.log("data: ",h),r(h),d(""),g(""),k.push("./posts");case 29:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h2",{children:f}),Object(s.jsxs)("form",{onSubmit:y,children:[Object(s.jsx)("input",{type:"text",value:l,onChange:function(e){return d(e.target.value)},placeholder:"username"}),Object(s.jsx)("input",{type:"password",value:O,onChange:function(e){return g(e.target.value)},placeholder:"password"}),Object(s.jsx)("button",{type:"submit",children:f})]}),Object(s.jsx)(h.b,{to:"/".concat(v),children:m})]})}),b=function(e){var t=e.posts,n=e.setPosts,r=e.token;Object(i.useEffect)((function(){o(),console.log("posts: ")}),[]);var o=function(){var e=Object(a.a)(c.a.mark((function e(){var t,s,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r){e.next=10;break}return e.next=3,fetch("http://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{headers:{Authorization:"Bearer ".concat(r)}});case 3:return t=e.sent,e.next=6,t.json();case 6:s=e.sent,n(s.data.posts),e.next=18;break;case 10:if(r){e.next=18;break}return e.next=13,fetch("http://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts");case 13:return a=e.sent,e.next=16,a.json();case 16:o=e.sent,n(o.data.posts);case 18:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h1",{children:"Posts"}),t&&t.map((function(e){return Object(s.jsx)(k,{token:r,posts:t,setPosts:n,post:e},e._id)}))]})},x=function(e){var t=e.token,n=e.setToken;return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("nav",{children:[Object(s.jsx)(h.b,{to:"/",children:"Home"}),Object(s.jsx)(h.b,{to:"/login",children:"Login"}),Object(s.jsx)(h.b,{to:"/register",children:"Register"}),Object(s.jsx)(h.b,{to:"/posts",children:"Posts"}),t&&Object(s.jsx)(h.b,{to:"/profile",children:"Profile"}),t&&Object(s.jsx)(h.b,{to:"/createpost",children:"Add Posts"}),t&&Object(s.jsx)("button",{onClick:function(){localStorage.removeItem("token"),n("")},children:" Logout"})]})})},O=n(24),g=function(e){var t=e.token,n=e.posts,r=e.setPosts,u=Object(i.useState)(""),j=Object(o.a)(u,2),p=j[0],h=j[1],l=Object(i.useState)(""),d=Object(o.a)(l,2),b=d[0],x=d[1],g=Object(i.useState)(""),f=Object(o.a)(g,2),m=f[0],v=f[1],k=function(){var e=Object(a.a)(c.a.mark((function e(s){var a,o,i;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return s.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({post:{title:p,description:b,price:m}})});case 3:return a=e.sent,e.next=6,a.json();case 6:o=e.sent,i=o.data,h(""),x(""),v(""),r([].concat(Object(O.a)(n),[i.post]));case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(s.jsx)(s.Fragment,{children:Object(s.jsxs)("form",{onSubmit:k,children:[Object(s.jsx)("input",{type:"text",value:p,onChange:function(e){return h(e.target.value)},placeholder:"title"}),Object(s.jsx)("input",{type:"text",value:b,onChange:function(e){return x(e.target.value)},placeholder:"description"}),Object(s.jsx)("input",{type:"text",value:m,onChange:function(e){return v(e.target.value)},placeholder:"price"}),Object(s.jsx)("button",{type:"submit",placeholder:"Create Post",children:"Post"})]})})},f=function(e){var t=e.posts,n=(e.setPosts,Object(p.f)().id),r=Object(i.useState)((function(){return t.find((function(e){return e._id===n}))})),c=Object(o.a)(r,2),a=c[0];c[1];return a?Object(s.jsx)(k,{post:a}):""},m=n(39),v=n(40),k=function(e){var t=e.post,n=e.posts,r=e.setPosts,u=e.token,j=Object(i.useState)(""),p=Object(o.a)(j,2),l=p[0],d=p[1],b=function(){var e=Object(a.a)(c.a.mark((function e(){var s,a,o;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(t._id),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u)}});case 2:return s=e.sent,e.next=5,s.json();case 5:a=e.sent,a.success&&(o=n.filter((function(e){return e._id!==t._id})),r(o));case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(a.a)(c.a.mark((function e(n){var s,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/posts/".concat(t._id,"/messages"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(u)},body:JSON.stringify({message:{content:l}})});case 3:return s=e.sent,e.next=6,s.json();case 6:r=e.sent,r.data,d("");case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t?Object(s.jsxs)(s.Fragment,{children:[Object(s.jsxs)(m.a,{children:[Object(s.jsxs)(h.b,{to:"/posts/".concat(t._id),children:[" ",Object(s.jsx)("h3",{children:t.title})," "]}),Object(s.jsx)("div",{children:t.description}),Object(s.jsx)("div",{children:t.body})]}),u&&!t.isAuthor&&Object(s.jsxs)("form",{onSubmit:x,children:[Object(s.jsx)("input",{type:"text",value:l,onChange:function(e){return d(e.target.value)},placeholder:"message"}),Object(s.jsx)(v.a,{type:"submit",variant:"primary",children:"Send Message"})]}),t.isAuthor&&Object(s.jsx)(v.a,{type:"button",variant:"danger",onClick:b,children:"Delete"})]}):""},y=function(e){var t=e.user;return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h1",{children:"Messages"}),t&&t.messages&&t.messages.map((function(e){return Object(s.jsxs)(m.a,{children:[Object(s.jsxs)("div",{children:["Post Title:",e.post.title]}),Object(s.jsxs)("div",{children:["User:",e.fromUser.username]}),Object(s.jsxs)("div",{children:["Content:",e.content]})]},e._id)}))]})},P=function(){var e=Object(i.useState)((function(){return localStorage.getItem("token")?localStorage.getItem("token"):""})),t=Object(o.a)(e,2),n=t[0],r=t[1],u=Object(i.useState)({}),j=Object(o.a)(u,2),h=j[0],O=j[1],m=Object(i.useState)([]),v=Object(o.a)(m,2),k=v[0],P=v[1];Object(i.useEffect)((function(){S(),console.log("user: ")}),[n]);var S=function(){var e=Object(a.a)(c.a.mark((function e(){var t,s;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("https://strangers-things.herokuapp.com/api/2010-CPU-RM-WEB-PT/users/me",{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)}});case 2:return t=e.sent,e.next=5,t.json();case 5:s=e.sent,console.log(s),O(s.data);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.jsxs)(s.Fragment,{children:[Object(s.jsx)("h1",{style:l,children:"Strangers Things"}),(null===h||void 0===h?void 0:h.username)&&Object(s.jsxs)("div",{children:["Hello ",null===h||void 0===h?void 0:h.username]}),Object(s.jsx)(x,{token:n,setToken:r}),Object(s.jsx)(p.a,{exact:!0,path:"/login",children:Object(s.jsx)(d,{type:"login",setToken:r,setUser:O})}),Object(s.jsx)(p.a,{exact:!0,path:"/register",children:Object(s.jsx)(d,{type:"register",setToken:r,setUser:O})}),Object(s.jsx)(p.a,{exact:!0,path:"/posts",children:Object(s.jsx)(b,{posts:k,setPosts:P,token:n})}),Object(s.jsx)(p.a,{exact:!0,path:"/",children:Object(s.jsx)("h1",{children:"Welcome to Stranger's Things!"})}),Object(s.jsx)(p.a,{exact:!0,path:"/posts/:id",children:Object(s.jsx)(f,{posts:k,setPosts:P})}),Object(s.jsx)(p.a,{exact:!0,path:"/createpost",children:Object(s.jsx)(g,{posts:k,setPosts:P,token:n})}),Object(s.jsx)(p.a,{exact:!0,path:"/profile",children:Object(s.jsx)(y,{user:h})})]})};j.a.render(Object(s.jsx)(h.a,{children:Object(s.jsx)(P,{})}),document.getElementById("app"))}},[[38,1,2]]]);
//# sourceMappingURL=main.2c7a6b3b.chunk.js.map